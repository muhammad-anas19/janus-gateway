version: "3.8"

services:
  janus-gateway:
    image: canyan/janus-gateway:latest
    container_name: janus-gateway
    restart: unless-stopped
    labels:
        - "traefik.enable=true"
        - "traefik.http.routers.janus-gateway.rule=Host(`janus-gateway.coolify.arcsip.io`)"
        - "traefik.http.services.janus-gateway.loadbalancer.server.port=8188"

    # Port mappings
    ports:
      # HTTP/HTTPS API (optional, for admin)
      # - "8088:8088"
      # - "8089:8089"
      # WebSocket (unsecured - for internal use or proxy)
      - "8188:8188"
      # Secure WebSocket (for production)
      # - "8989:8989"
      # RTP media ports (UDP) - CRITICAL for audio
      - "20000-20100:20000-20100/udp"
      # SIP signaling
      - "5060:5060/udp"
      - "5060:5060/tcp"

    # Mount configuration files
    volumes:
      - ./janus-config:/opt/janus/etc/janus:ro
      - ./certs:/opt/janus/share/janus/certs:ro

    # Environment variables
    environment:
      - JANUS_DEBUG_LEVEL=4

    # Health check
